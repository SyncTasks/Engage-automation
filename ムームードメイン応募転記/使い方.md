# Engage応募メール自動処理システム

ムームードメインのメールサーバーにIMAP接続し、Engageからの応募メールを自動処理します。

## 機能

- **IMAP接続**: ムームードメインのメールサーバーに直接接続
- **メール検索**: Engageからの未処理メールを自動検索
- **情報抽出**: 件名から応募者名・求人タイトルを抽出
- **ChatGPT連携**: HTML本文から都道府県・企業名をAIで抽出
- **スプレッドシート記録**: 応募情報を自動転記（重複チェック付き）
- **Chatwork通知**: 新規応募をChatworkに通知

## セットアップ

### 1. 初期セットアップ

`初期セットアップ.bat` をダブルクリックして実行します。

### 2. 環境変数の設定

`.env` ファイルを編集して認証情報を設定します。

```
GOOGLE_CREDENTIALS={"type":"service_account",...}
OPENAI_API_KEY=sk-...
```

または `credentials.json` をこのフォルダに配置します。

### 3. 動作確認

`実行.bat` をダブルクリックして手動実行し、正常に動作することを確認します。

### 4. タスクスケジューラに登録

1. 「タスクスケジューラ」を開く
2. 「タスクの作成」をクリック
3. 設定例:

| 項目 | 設定値 |
|------|--------|
| 名前 | Engage応募チェック |
| トリガー | 毎日、1時間ごとに繰り返し |
| 操作 | `実行.bat` のフルパスを指定 |
| 開始 | `実行.bat` があるフォルダ |
| 条件 | 「コンピューターをAC電源で使用している場合のみ」はオフ推奨 |

## ファイル構成

```
ムームードメイン応募転記/
├── 応募メール処理.py      # メイン処理
├── 必要パッケージ.txt      # 依存パッケージ
├── 初期セットアップ.bat    # 初期セットアップ用
├── 実行.bat               # タスクスケジューラから実行するバッチ
├── .env                   # 環境変数（Git管理外）
├── credentials.json       # Google認証（Git管理外、任意）
└── 使い方.md              # このファイル
```
